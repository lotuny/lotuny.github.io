<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Azure Data Explorer (Kusto) | Lotuny's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/css/dark.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 5.4.1"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Azure Data Explorer (Kusto)</h1><a id="logo" href="/.">Lotuny's Blog</a><p class="description"></p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Azure Data Explorer (Kusto)</h1><div class="post-meta">2022-02-21<span> | </span><span class="category"><a href="/categories/Azure/">Azure</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#How-to-Guides"><span class="toc-number">1.</span> <span class="toc-text">How-to Guides</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Purge"><span class="toc-number">1.1.</span> <span class="toc-text">Purge</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kusto-Query-Language-KQL"><span class="toc-number">2.</span> <span class="toc-text">Kusto Query Language (KQL)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Tabular-operations"><span class="toc-number">2.1.</span> <span class="toc-text">Tabular operations</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#join-operator"><span class="toc-number">2.1.1.</span> <span class="toc-text">join operator</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Aggregation-Functions"><span class="toc-number">2.2.</span> <span class="toc-text">Aggregation Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hll"><span class="toc-number">2.2.1.</span> <span class="toc-text">hll()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tdigest"><span class="toc-number">2.2.2.</span> <span class="toc-text">tdigest()</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><blockquote>
<p><strong>Azure Data Explorer</strong> is a fully managed, high-performance, big data analytics platform that makes it easy to analyze high volumes of data in near real time.</p>
</blockquote>
<span id="more"></span>

<h2 id="How-to-Guides"><a href="#How-to-Guides" class="headerlink" title="How-to Guides"></a>How-to Guides</h2><h3 id="Purge"><a href="#Purge" class="headerlink" title="Purge"></a>Purge</h3><p>Purge is designed to be used to protect personal data for obligations under the GDPR. It is not designed to support frequent delete requests or deletion of massive quantities of data, and may have a siginificant performance impact on the service. For other scenarios, retention policy is more suitable.</p>
<p><strong>Prerequisite</strong>: Enable data purge on your cluster through Azure Portal (Settings/Configurations -&gt; Enable purge) and save.</p>
<p><strong>Purge syntax</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// Connect to the Data Management service</span><br><span class="line">#connect &quot;https://ingest-[YourClusterName].[region].kusto.windows.net&quot; </span><br><span class="line"></span><br><span class="line">// To purge table records</span><br><span class="line">.purge table [TableName] records in database [DatabaseName] with (noregrets=&#x27;true&#x27;) &lt;| [Predicate]</span><br><span class="line"></span><br><span class="line">// To purge materialized view records</span><br><span class="line">.purge materialized-view [MaterializedViewName] records in database [DatabaseName] with (noregrets=&#x27;true&#x27;) &lt;| [Predicate]</span><br></pre></td></tr></table></figure>

<p><strong>Track status</strong>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.show purges &lt;OperationId&gt;</span><br><span class="line">.show purges [in database &lt;DatabaseName&gt;]</span><br><span class="line">.show purges from &#x27;&lt;StartDate&gt;&#x27; [in database &lt;DatabaseName&gt;]</span><br><span class="line">.show purges from &#x27;&lt;StartDate&gt;&#x27; to &#x27;&lt;EndDate&gt;&#x27; [in database &lt;DatabaseName&gt;]</span><br></pre></td></tr></table></figure>

<h2 id="Kusto-Query-Language-KQL"><a href="#Kusto-Query-Language-KQL" class="headerlink" title="Kusto Query Language (KQL)"></a>Kusto Query Language (KQL)</h2><h3 id="Tabular-operations"><a href="#Tabular-operations" class="headerlink" title="Tabular operations"></a>Tabular operations</h3><h4 id="join-operator"><a href="#join-operator" class="headerlink" title="join operator"></a>join operator</h4><p><code>Table1 | join kind=JoinFlavor (Table 2) on CommonColumn, $left.Col1 == $right.Col2</code></p>
<p>Join flavors: innerunique (default), inner, leftouter, rightouter, fullouter, leftanti, rightanti, leftsemi, rightsemi</p>
<h3 id="Aggregation-Functions"><a href="#Aggregation-Functions" class="headerlink" title="Aggregation Functions"></a>Aggregation Functions</h3><h4 id="hll"><a href="#hll" class="headerlink" title="hll()"></a>hll()</h4><p><code>| summarize hll(column1) by column2</code></p>
<p>HyperLogLog is a probabilistic algorithm to estimate the number of distinct values in a set.</p>
<p>The basis of the HyperLogLog algorithm is the observation that the cardinality of a multiset of uniformly distributed random numbers can be estimated by calculating the maximum number of leading zeros in the binary representation of each number in the set. If the maximum number of leading zeros observed is n, an estimate for the number of distinct elements in the set is 2^n.</p>
<p>First, all values should be hashed to uniformly distributed random numbers. To minimise the variance, the numbers can be splitted to numerous subsets. After then, find the maximum number of leading zeros in each subset, use a harmonic mean to combine these estimates, and obtain an estimate of the cardinality of the whole set.</p>
<p>Reference: <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/HyperLogLog">https://en.wikipedia.org/wiki/HyperLogLog</a></p>
<h4 id="tdigest"><a href="#tdigest" class="headerlink" title="tdigest()"></a>tdigest()</h4><p><code>| summarize tdigest(column1) by column2</code></p>
<p>Calculates the intermediate results for percentile across the group, which are represented as a dynamic array. For example, the result <code>[[5],[2,3],[1,2]]</code> for a specific group means there are 5 groups in total, with one 2 and two 3s in this group.</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2022/02/21/reading/animal-farm/">Animal Farm</a><a class="next" href="/2022/02/20/coding-interview/coding-interview-6/">å‰‘æŒ‡Offeré¢è¯•é¢˜6ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://lotuny.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Application/">Application</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Azure/">Azure</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Coding-Interview-Edition-2/">Coding Interview Edition 2</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Command/">Command</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Computer-Network/">Computer Network</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Language/">Language</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reading/">Reading</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Test/">Test</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Uncategorized/">Uncategorized</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/Blog/" style="font-size: 15px;">Blog</a> <a href="/tags/Computer-Network/" style="font-size: 15px;">Computer Network</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Security/" style="font-size: 15px;">Security</a> <a href="/tags/Web/" style="font-size: 15px;">Web</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/Automation-Test/" style="font-size: 15px;">Automation Test</a> <a href="/tags/Array/" style="font-size: 15px;">Array</a> <a href="/tags/Novella/" style="font-size: 15px;">Novella</a> <a href="/tags/Binary-Tree%EF%BC%88%E4%BA%8C%E5%8F%89%E6%A0%91%EF%BC%89/" style="font-size: 15px;">Binary Treeï¼ˆäºŒå‰æ ‘ï¼‰</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/03/03/coding-interview/coding-interview-8/">å‰‘æŒ‡Offeré¢è¯•é¢˜8ï¼šäºŒå‰æ ‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/02/coding-interview/coding-interview-7/">å‰‘æŒ‡Offeré¢è¯•é¢˜7ï¼šé‡å»ºäºŒå‰æ ‘</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/22/language-csharp/">C#</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/21/reading/animal-farm/">Animal Farm</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/21/azure/azure-data-explorer/">Azure Data Explorer (Kusto)</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/20/coding-interview/coding-interview-6/">å‰‘æŒ‡Offeré¢è¯•é¢˜6ï¼šä»å°¾åˆ°å¤´æ‰“å°é“¾è¡¨</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/20/coding-interview/coding-interview-5/">å‰‘æŒ‡Offeré¢è¯•é¢˜5ï¼šæ›¿æ¢ç©ºæ ¼</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/20/coding-interview/coding-interview-4/">å‰‘æŒ‡Offeré¢è¯•é¢˜4ï¼šäºŒç»´æ•°ç»„ä¸­çš„æŸ¥æ‰¾</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/19/coding-interview/coding-interview-3/">å‰‘æŒ‡Offeré¢è¯•é¢˜3ï¼šæ•°ç»„ä¸­é‡å¤çš„æ•°å­—</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/19/coding-interview/coding-interview-0/">å‰‘æŒ‡Offeré¢˜è§£å‰è¨€</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://github.com/lotuny" title="GitHub - Lotuny" target="_blank">GitHub - Lotuny</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2022 <a href="/." rel="nofollow">Lotuny's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>